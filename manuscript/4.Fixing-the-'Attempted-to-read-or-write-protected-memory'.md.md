## Fixing the 'Attempted to read or write protected memory' issue

I added the **Patch_IgnoreArgsInAttach** property

![image](images/image_thumb_25255B71_25255D.png)

Which is then used here (to allow the selection of the path that works)

![image](images/image_thumb_25255B72_25255D.png)

I also changed the assembly name (so it is easy to track its use):

![image](images/image_thumb_25255B73_25255D.png)

After the compilation I copied it to the main target folder:

![image](images/image_thumb_25255B74_25255D.png)

To test it , I used the script

![image](images/image_thumb_25255B77_25255D.png)]

to start ZAP with a REPL, where I could execute OK:

![image](images/image_thumb_25255B76_25255D.png)

Final step is to create a zip of the bin folder

![image](images/image_thumb_25255B78_25255D.png)

Put it on a public [available location like DropBox](https://dl.dropboxusercontent.com/u/81532342/O2%20Files/jni4net-0.8.7.0-bin_Patched.zip)

Update the installer API to use that version:

![image](images/image_thumb_25255B79_25255D.png)

Update the API_Jni4Net.cs to use the jni4net.n-0.8.7.0_Patched.dll assembly (as seen below on first compile the referenced will be downloaded)

![image](images/image_thumb_25255B80_25255D.png)

once the compilation works:

![image](images/image_thumb_25255B81_25255D.png)

Running Jni4Net works locally

![image](images/image_thumb_25255B82_25255D.png)

And so does on 'injected into' java processes:

![image](images/image_thumb_25255B83_25255D.png)

Finally I can add a remote to the local repo:

![image](images/image_thumb_25255B85_25255D.png)

push it

![image](images/image_thumb_25255B86_25255D.png)

And confirm that the commits I did locally (with the patch)

![image](images/image_thumb_25255B87_25255D.png)

where pushed successfully:

![image](images/image_thumb_25255B88_25255D.png)


**Starting ZAP programmatically**

Here is a script that starts (and downloads on first run) the latest version of ZAP (return value is the new ZAP process, and ZAP's console out are being captured in the O2's LogViewer):

![image](images/image_thumb_25255B1_25255D1.png)

Here is the contents of the API_Zap.cs file (consumed above):

![image](images/image_thumb_25255B2_25255D1.png)

**Setting default folders**

In this case I also had to update the location of the temp and O2.Platform.Scripts folder (usually not needed)

![image](images/image_thumb_25255B5_25255D1.png)
